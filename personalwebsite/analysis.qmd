---
title: "Example Analysis - Flight Delays at BWI"
---

![](OG-RouteMap.webp){width="693"}

In this analysis, I explore what factors characterize delayed flights out of BWI airport. Which airline carriers are most likely to have delayed flights? Are flights more likely to be delayed during certain months? Are there certain airport destinations that have a higher rate of delays from Baltimore compared to other destinations? This analysis intended for air travelers in the U.S., frequent or infrequent, sheds some light on the previous questions using U.S. domestic flight data from 2015. This dataset is from [Kaggle](https://www.kaggle.com/datasets/usdot/flight-delays?select=flights.csv) and was originally produced by the Department of Transportation's Bureau of Transportation Statistics. The original dataset has 5.8 million observations, each one a different flight, and 31 columns with information about the flight including date of flight, carrier, flight status, and reason for possible delay, diversion, or cancellation. To narrow down the data analysis, I filtered the data to only include flights departing from BWI so I can focus the analysis on flight status out of BWI airport. There were 86,079 flight observations out of BWI in 2015.

```{r}
#| echo: true
#| output: false

library(dplyr) 
library(stringr)
library(knitr)
library(ggplot2)
library(kableExtra)
```

```{r}
#| eval: false

flights <- read.csv("flights.csv") # Read in data

flights.bwi <- flights %>% # Filter by only flights originating from Baltimore
  filter(ORIGIN_AIRPORT == "BWI")
write.csv(flights.bwi, "flights_bwi.csv")
```

```{r}
flights_bwi <- read.csv("flights_bwi.csv") # Reread in smaller dataset
airports <- read.csv("airports.csv") # Read in airport and airline data
airlines <- read.csv("airlines.csv")
```

# Data Dictionary

```{r}
#| echo: false
#| column: margin
knitr::kable(
  airlines[1:14, 1:2]
)
```

| Variable            | Description                                                                                                                     |
|-----------------------|-------------------------------------------------|
| Year                | Year of the Flight Trip                                                                                                         |
| Month               | Month of the Flight Trip                                                                                                        |
| Day                 | Day of the Flight Trip                                                                                                          |
| Day_of_Week         | Day of week of the Flight Trip                                                                                                  |
| Airline             | Airline Identifier (See table in right margin for airline codes)                                                                |
| Flight_Number       | Flight Identifier                                                                                                               |
| Tail_Number         | Aircraft Identifier                                                                                                             |
| Origin_Airport      | Starting Airport (All BWI for this analysis)                                                                                    |
| Destination_Airport | Destination Airport (See list of airport codes [here](https://www.nationsonline.org/oneworld/IATA_Codes/airport_code_list.htm)) |
| Scheduled_Departure | Planned Departure Time                                                                                                          |
| Departure_Time      | Wheel_Off - Taxi_Out                                                                                                            |
| Departure_Delay     | Total Delay on Departure                                                                                                        |
| Taxi_Out            | The time duration elapsed between departure from the origin airport gate and wheels off                                         |
| Wheels_Off          | The time point that the aircraft's wheels leave the ground                                                                      |
| Scheduled_Time      | Planned time amount needed for the flight trip                                                                                  |
| Elapsed_Time        | Air_Time +Taxi_In + Taxi_Out                                                                                                    |
| Air_Time            | The time duration between wheels_off and wheels_on time                                                                         |
| Distance            | Distance between two airports                                                                                                   |
| Wheels_On           | The time point that the aircraft's wheels touch on the ground                                                                   |
| Taxi_In             | The time duration elapsed between wheels-on and gate arrival at the destination airport                                         |
| Scheduled_Arrival   | Planned arrival time                                                                                                            |
| Arrival_Time        | Wheels_On + Taxi_In                                                                                                             |
| Arrival_Delay       | Arrival_Time - Scheduled_Arrival                                                                                                |
| Diverted            | Aircraft landed on airport that out of schedule                                                                                 |
| Cancelled           | Flight Cancelled (1 = cancelled)                                                                                                |
| Cancellation_Reason | Reason for Cancellation of flight: A - Airline/Carrier; B - Weather; C - National Air System; D - Security                      |
| Air_System_Delay    | Delay caused by air system                                                                                                      |
| Security_Delay      | Delay caused by security                                                                                                        |
| Airline_Delay       | Delay caused by the airline                                                                                                     |
| Late_Aircraft_Delay | Delay caused by aircraft                                                                                                        |
| Weather_Delay       | Delay caused by weather                                                                                                         |

Which airline carriers are most likely to have delayed flights? Are flights more likely to be delayed during certain months? Are there certain airport destinations that have a higher rate of delays from Baltimore compared to other destinations?

# Analysis

```{r}
flights_bwi %>% 
  filter(DEPARTURE_DELAY > 0) %>% 
  nrow / nrow(flights_bwi)

delayed <- flights_bwi %>% 
  filter(DEPARTURE_DELAY > 15) 
nrow(delayed) / nrow(flights_bwi)
```

48.6% of flights out of BWI in 2015 were delayed. However, the Federal Aviation Administration defines a delay as a flight that leaves 15 or more minutes late. Using this definition, 23.3% of flights out of BWI were delayed. https://aspm.faa.gov/aspmhelp/index/Types_of_Delay.html

```{r}
delay_by_airline <- flights_bwi %>% 
  mutate(delay_status = ifelse(DEPARTURE_DELAY > 15, 1, 0)) %>% 
  filter(!is.na(delay_status)) 

summarized_delays <- delay_by_airline %>% 
  group_by(AIRLINE) %>% 
  summarize(num_delayed_flights = sum(delay_status,na.rm = T), total_flights = n(), proportion_of_flights_delayed = sum(delay_status, na.rm = T)/n()) %>% 
  arrange(-proportion_of_flights_delayed)
summarized_delays
```

This table sorts the airlines by proportion of flights delayed from most to least.

::: callout-note
Skywest only has one observation in this dataset and it was a delay, so I will remove it from analysis on which airlines have the highest rate of delay since it skews the results.
:::

```{r}
delay_by_airline <- delay_by_airline %>% 
  filter(AIRLINE != "OO") %>% 
  mutate(AIRLINE = reorder(AIRLINE, -delay_status))

ggplot(delay_by_airline, aes(fill = as.factor(delay_status), y = length(delay_status), x = AIRLINE)) + 
  geom_bar(position="fill", stat="identity") + ggtitle("Proportion of Flights Delayed out of BWI by Airline") + 
  xlab("Airline") + 
  ylab("Proportion of Flights Delayed") + 
  guides(fill=guide_legend(title="Delay Status")) + 
scale_fill_manual(labels = c("No", "Yes"), values = c("green4", "orange2")) + 
  theme(title = element_text(family = "Optima"), legend.text = element_text(family = "Optima"), axis.text.x = element_text(family = "Optima"), axis.text.y = element_text(family = "Optima")) + 
  labs(subtitle = str_wrap("Spirit Airlines and Southwest Airlines have the highest proportion of delayed flights while US Airways has the lowest"), caption = "Figure 1: Flights ranked by delay status")
```

```{r}
summarized_delays %>% 
  filter(AIRLINE != "OO") %>% 
  ggplot(aes(x = reorder(AIRLINE,-total_flights),y = total_flights)) +
  geom_bar(stat = "identity", fill = "green4") + ylab("Total Number of Flights") + xlab("Airline") + ggtitle("Frequency of Flights out of BWI by Airline") +
  theme(title = element_text(family = "Optima"), legend.text = element_text(family = "Optima"), axis.text.x = element_text(family = "Optima"), axis.text.y = element_text(family = "Optima")) + labs(subtitle = "")
```

```{r}

```

```{r}
flights_bwi %>% 
  ggplot(aes(DEPARTURE_DELAY)) +
  geom_histogram()

flights_bwi %>% 
  select(DEPARTURE_DELAY) %>% 
  max(na.rm=T) / 60
```

By times of year - each month and then certain periods including thanksgiving and Christmas

## Functions Used

**dplyr:**

filter()\
mutate()\
group_by()\
summarize()\
arrange()\
n()
